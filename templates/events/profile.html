{% extends 'events/base.html' %}
{% block title %}
    Profile
{% endblock %}
{% if user.is_authenticated %}
    {% block content %}
        <div class="content">
            <div>
                <h1>Просмотр отправляемых приглашений</h1>
                <form class="form-inline" method="POST" action="/api/invitations/change">
                {% csrf_token %}
                <label class="mr-sm-2" for="inlineFormCustomSelect">Выберите мероприятие</label>
                <select name="event" class="custom-select mb-2 mr-sm-2 mb-sm-0" id="inlineFormCustomSelect">
                    <option selected>{{ selected_event }}</option>
                    {% for e in user_events %}
                        <option value="{{ e.id }}">{{ e.name }}</option>
                    {% endfor %}
                </select>
                <button type="submit" class="btn btn-primary" id="generate">filter</button>
            </form>
            </div>
                <table class="table table-hover">
                    <thead>
                        <tr>
                            <th>#</th>
                            <th>Event</th>
                            <th>Recipient</th>
                            <th>Link</th>
                            <th>Count</th>
                            <th> </th>
                            <th> </th>
                        </tr>
                    </thead>
                      <tbody>
                        {% for i in invitations %}
                            <tr>
                                <th>{{ forloop.counter }}</th>
                                <td>{{ i.event }}</td>
                                <td>{{ i.recipient }}</td>
                                <td>
                                    <a href="http://localhost:8000/invitation/{{ i.key }}">http://localhost:8000/invitation/{{ i.key }}</a>
                                </td>
                                <form class="form" method="POST" action="/api/invitations/edit/{{i.id}}">
                                    {% csrf_token %}
                                    <input type="hidden" name="id" value="{{ i.id }}">
                                    <td width="200px">
                                        <input class="form-control"
                                               value="{{ i.count }}" name="count"
                                               id="number-{{ i.id }}">
                                    </td>
                                    <td>
                                        <button type="submit" class="btn btn-primary" id="submit">submit</button>
                                    </td>
                                </form>
                                <form class="form" method="POST" action="/api/invitations/delete/{{i.id}}">
                                    {% csrf_token %}
                                    <td>
                                        <button type="submit" value="{{ i.id }}" name="id" class="btn btn-danger" id="delete">
                                            delete
                                        </button>
                                    </td>
                                </form>
                            </tr>
                        {% endfor %}
                      </tbody>
                </table>
        </div>
    {% endblock %}
{% endif %}